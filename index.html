
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Savagejen's Octopress Blog</title>
  <meta name="author" content="Jen Savage">

  
  <meta name="description" content="Reading through documentation, I noticed a peculiarity about python: it&#8217;s susceptible to library hijacking attacks. Open your python &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://savagejen.github.io">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Savagejen's Octopress Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Savagejen's Octopress Blog</a></h1>
  
    <h2>Github is the new facebook</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:savagejen.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/28/python-module-hijacking/">Python Module Hijacking</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-28T23:03:00-05:00" pubdate data-updated="true">Apr 28<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Reading through documentation, I noticed a peculiarity about python: it&#8217;s susceptible to library hijacking attacks.</p>

<p>Open your python interpreter and type in:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>import sys
</span><span class='line'>print sys.path</span></code></pre></td></tr></table></div></figure>


<p>The result should be a list of paths that python will look in to find a module, in the order that python looks for them in. In other words, a pythonpath is the python equivalent of a DLL search path in windows.</p>

<p>You&#8217;ll note that the very first item on the list is &#8221;, which means your current working directory. So if you import io, the first place python will look for the io module is your current working directory.</p>

<p>Now, let&#8217;s say that someone places an io.py file in the same directory as your script. Now, the next time your script is run, it will load their version of io instead of yours. A user can essentially hijack the intended functionality of a module and replace it with their own, and all they need are write permissions to the same directory as your python script. For servers that offer shells to a variety of users, this type of attack could be used as a local privelege escalation on that box.</p>

<p>For example, here we have a script poc.py that opens a file (I know, not very useful, but it&#8217;s an example, so shhhh)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>import io
</span><span class='line'>
</span><span class='line'>io.open('spam.txt', 'w')</span></code></pre></td></tr></table></div></figure>


<p>If you place this script in the same directory as the following io.py file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>def open(foo,bar):
</span><span class='line'>  print "Pining for the fjords?!"</span></code></pre></td></tr></table></div></figure>


<p>Then when you go to run poc.py, you will get the output &#8220;Pining for the fjords?!&#8221;</p>

<p>I sent this along to the python security team with a set of suggestions for fixing it. For one thing, I think the current working directory should be the last thing listed in the pythonpath by default. For another, python could provide a way for developers to specify the static path to their modules.</p>

<p>The python security team let me know that this attack is already well known to them, and they have something called isolation mode planned for a future version of python.</p>

<p>In the meantime, I&#8217;m told that you can configure virtualenv to only allow specific modules to be used by your python applications.</p>

<p>And sysadmins, please, <em>never</em> allow people to write to the same directories that your python scripts run out of.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/28/the-patsy-proxy/">The Patsy Proxy</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-28T22:56:00-05:00" pubdate data-updated="true">Apr 28<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><iframe width="420" height="315" src="http://www.youtube.com/embed/UrjrVcv2jsE" frameborder="0" allowfullscreen></iframe>


<p>The Patsy Proxy was a talk that I gave with Dan Crowley at Derbycon 2 and Defcon 20 Skytalks. It was recorded at Derbycon and is available to view via YouTube.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/28/uploaded-my-old-sparkl-motion-code-to-github/">Uploaded My Old Sparkl Motion Code to Github</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-28T22:42:00-05:00" pubdate data-updated="true">Apr 28<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Sparkl Motion was my first Arduino project. I used the input from an accelerometer to modify the rate of change of output via pwm to power a strand of LEDs on a necklace. The result were LEDs that &#8220;sparkled&#8221; quicker or slower depending on your movement.</p>

<object type="application/x-shockwave-flash" width="400" height="300" data="http://www.flickr.com/apps/video/stewart.swf?v=109786" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"> <param name="flashvars" value="intl_lang=en-us&photo_secret=ac66ef55cb&photo_id=4448899259"></param> <param name="movie" value="http://www.flickr.com/apps/video/stewart.swf?v=109786"></param> <param name="bgcolor" value="#000000"></param> <param name="allowFullScreen" value="true"></param><embed type="application/x-shockwave-flash" src="http://www.flickr.com/apps/video/stewart.swf?v=109786" bgcolor="#000000" allowfullscreen="true" flashvars="intl_lang=en-us&photo_secret=ac66ef55cb&photo_id=4448899259" height="300" width="400"></embed></object>


<p>(<a href="https://github.com/savagejen/Arduino/tree/master/sparklmotion">The arduino sketch has now been uploaded to my github account</a>).</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/04/28/first-post/">First Post!</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-28T22:35:00-05:00" pubdate data-updated="true">Apr 28<span>th</span>, 2013</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Well, first post to this blog anyway. Since I gave up blogging in earnest ages ago, the purpose of this blog is to focus on tech rather than drivel on about life. If you want to hear me drivel on about life, check out: (<a href="https://twitter.com/savagejen">my twitter account</a>).</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/04/28/python-module-hijacking/">Python Module Hijacking</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/28/the-patsy-proxy/">The Patsy Proxy</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/28/uploaded-my-old-sparkl-motion-code-to-github/">Uploaded my old Sparkl Motion code to github</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/28/first-post/">First Post!</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/savagejen">@savagejen</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'savagejen',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/106577349578207351822?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Jen Savage -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
